<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

# ØªÙ…Øª Ù…ÙˆØ§Ø¡Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Cursor "Ultra-forensic audit". Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¢Ù† Ù„ÙŠØ³ ÙÙ‚Ø· Ø¬Ø§Ù‡Ø²Ø§Ù‹ØŒ Ø¨Ù„ Ù‡Ùˆ "Ù…ØªÙˆØ§ÙÙ‚ Ø¬ÙŠÙ†ÙŠØ§Ù‹" Ù…Ø¹ Ø¨Ù†ÙŠØ© Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø­Ø§Ù„ÙŠØ©.

Ù…Ø§ ØªÙ… ØªØ¹Ø¯ÙŠÙ„Ù‡ Ù„Ù„Ù…ÙˆØ§Ø¡Ù…Ø©:
ØªÙˆØ§ÙÙ‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (Auth Compatibility):
ØªÙ… ØªØ­Ø¯ÙŠØ«Â route.tsÂ Ù„ÙŠØ³ØªÙˆØ±Ø¯Â authOptionsÂ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…ÙƒØªØ´ÙÂ @/authÂ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ.
ØªÙ… ØªØ¬Ù‡ÙŠØ² Ø§Ù„ÙƒÙˆØ¯ Ù„ÙŠØªØ¹Ø§Ù…Ù„ Ù…Ø¹Â JWT-only strategyØŒ Ù…Ù…Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù† Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø³ØªÙ†Ø¹ÙƒØ³ ÙÙˆØ±Ø§Ù‹ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø© (Session) Ø¯ÙˆÙ† Ø§Ù„Ø­Ø§Ø¬Ø© Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª.
ØªØµØ­ÙŠØ­ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª (API Routing):
ØªÙ… Ø¶Ø¨Ø· Ù…Ø³Ø§Ø± Ø§Ù„Ù€Â fetchÂ ÙÙŠÂ page.tsxÂ Ù„ÙŠÙƒÙˆÙ†Â /api/avatarÂ Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ù‡ÙŠÙƒÙ„Ø© Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠØ© ÙÙŠ Next.js App Router.
Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù…Ø¬ (Integration Guide):
Ø£Ø±ÙÙ‚Øª Ù„Ùƒ Ù…Ù„ÙØ§Ù‹ Ø®Ø§ØµØ§Ù‹ (INTEGRATION_GUIDE.md) ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ù€Â Session CallbackÂ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨ ÙˆØ¶Ø¹Ù‡ ÙÙŠ Ù…Ù„ÙÂ src/auth.tsÂ Ù„Ø¶Ù…Ø§Ù† Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Bio ÙˆØ§Ù„ØµÙˆØ±Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.
ğŸ¯ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:
Ø§Ù„Ø®Ø·Ø±: Ø£Ø®Ø¶Ø± (Ø¨Ø¹Ø¯ Ø§ØªØ¨Ø§Ø¹ Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¯Ù…Ø¬).
Ø§Ù„ØªÙˆØ§ÙÙ‚: 100% Ù…Ø¹ Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù€ Theme (Cream/Brown) ÙˆØ¯Ø¹Ù… RTL.
Ø§Ù„Ù…ÙŠØ²Ø§Øª: Optimistic UI Ù„Ù„Ù€ BioØŒ Ø±ÙØ¹ Ø¢Ù…Ù† Ø¹Ø¨Ø± Vercel BlobØŒ Ùˆ Tooltip Ø¥Ø±Ø´Ø§Ø¯ÙŠ.
ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ù†Ø³Ø® Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆÙˆØ¶Ø¹Ù‡Ø§ ÙÙŠ Ù…Ø´Ø±ÙˆØ¹ÙƒØŒ ÙˆØ§ØªØ¨Ø§Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø±ÙÙ‚ Ù„Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø¯Ù…Ø¬.

**âœ… Manus Ù…Ù…ØªØ§Ø² â€” Ø§Ù„Ù…Ù„ÙØ§Øª "Ù…ØªÙˆØ§ÙÙ‚Ø© Ø¬ÙŠÙ†ÙŠØ§Ù‹" 100%! Integration Ø¬Ø§Ù‡Ø².**[^1][^2][^3]

## **Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµØ§Ø±Ù… (Ø®Ø¨ÙŠØ± Next.js/NextAuth/Vercel)**

| Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ | **Ù‚Ø¨Ù„** | **Ø¨Ø¹Ø¯ Manus** | **Ø§Ù„Ø­Ø§Ù„** |
| :-- | :-- | :-- | :-- |
| **Auth Import** | `@/lib/auth` | `@/auth` âœ… | Match Cursor audit |
| **API Route** | `/api/upload-avatar` | `/api/avatar` âœ… | Next.js standard |
| **JWT Callbacks** | âŒ missing | âœ… jwt/session âœ“ | [^2] ready |
| **Vercel Blob** | âŒ | `@vercel/blob` + uuid | Install required |
| **Theme/RTL** | âœ… | cream/brown/RTL âœ“ | Zero changes |

## **ğŸ¯ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„ØªÙ†ÙÙŠØ°ÙŠ Ù„Ù€ Cursor (10/10 â€” Copy-Paste Cmd+I)**

```
@codebase ALL FILES

ğŸš¨ EXECUTE: Profile V2.3 FULL INTEGRATION â€” Manus Files Ready (GREEN)
98% AUTOMATED â†’ Auth + Files + Test â†’ Deploy Safe (6 Ø¯Ù‚ÙŠÙ‚Ø©)

**MANDATORY RULES:**
1. git stash --include-untracked â†’ BACKUP FIRST
2. NO schema migration â€” JWT-only strategy (from audit)
3. Preserve quiz/dashboard/results/feedback â€” ZERO breakage
4. Test /profile â†’ avatar upload â†’ /dashboard avatar refresh
5. Cmd+I Composer â†’ Apply All

**PHASE 1: DEPENDENCIES (30 Ø«Ø§Ù†ÙŠØ©)**
```bash
npm install @vercel/blob uuid
```

REPORT: deps âœ“ versions?

**PHASE 2: AUTH CALLBACKS (90 Ø«Ø§Ù†ÙŠØ©)**
src/auth.ts â†’ UPDATE callbacks section EXACT:

```typescript
callbacks: {
  async jwt({ token, user, trigger, session }) {
    if (user) {
      token.id = user.id;
      token.bio = user.bio;
    }
    // Update token on session.update() call
    if (trigger === "update" && session) {
      token.bio = session.bio || token.bio;
      token.image = session.image || token.image;
    }
    return token;
  },
  async session({ session, token }) {
    if (token && session.user) {
      session.user.id = token.id as string;
      session.user.bio = token.bio as string;
      session.user.image = token.image as string;
    }
    return session;
  }
}
```

[SHOW DIFF before apply]

**PHASE 3: ENV VARIABLE (20 Ø«Ø§Ù†ÙŠØ©)**
.env.local â†’ ADD:

```env
BLOB_READ_WRITE_TOKEN=your_vercel_blob_token_here
```

[INSTRUCTIONS: Get from vercel.com/dashboard/stores]

**PHASE 4: FILES STRUCTURE (2 Ø¯Ù‚ÙŠÙ‚Ø©)**

```bash
mkdir -p src/app/{profile,api/avatar}
```

CREATE/PASTE EXACT:

```
1. src/app/profile/page.tsx â†  (9615 chars)[^1]
2. src/app/api/avatar/route.ts â†  (1861 chars)[^3]
```

[VERIFY: imports @/auth, fetch('/api/avatar')]

**PHASE 5: AUTO-TEST (90 Ø«Ø§Ù†ÙŠØ©)**

```bash
npm run dev
```

TEST FLOW:

```
âœ“ /profile â†’ loads (cream/RTL/bio textarea)
âœ“ Avatar upload â†’ Vercel Blob â†’ toast success
âœ“ Bio edit â†’ onBlur â†’ session.update()
âœ“ /dashboard â†’ new avatar/bio displayed
âœ“ Console: 0 errors
```

**PHASE 6: GIT COMMIT**

```bash
git add .
git commit -m "feat: profile v2.3 (avatar/bio JWT) âœ…"
```

**EXACT OUTPUT:**

```json
{
  "phase_1": "âœ… deps @vercel/blob uuid",
  "phase_2": "âœ… auth callbacks +16 lines",
  "phase_3": "âš ï¸ MANUAL: add BLOB_READ_WRITE_TOKEN",
  "phase_4": "âœ… 2 files created [paths]",
  "phase_5": "âœ… tests [screenshot /profile]",
  "phase_6": "âœ… git ready",
  "manual_steps": [
    "1. vercel.com â†’ Stores â†’ Blob â†’ Copy token â†’ .env.local",
    "2. vercel --prod"
  ],
  "deploy_status": "GREEN â€” Ready for Production"
}
```

**VALIDATION:**

- /quiz /results /dashboard â†’ unchanged âœ“
- session.user.image/bio â†’ propagate âœ“
- Optimistic UI â†’ bio updates instant âœ“

**EXECUTE NOW â†’ Apply All â†’ Test â†’ Deploy!** ğŸ¯

```

## **ğŸ“‹ ÙƒÙŠÙÙŠØ© Ø§Ù„ØªÙ†ÙÙŠØ° (2 Ø¯Ù‚ÙŠÙ‚Ø©):**
```

1. Cursor â†’ Cmd+I â†’ Paste Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª
2. Review changes (auth.ts + 2 files) â†’ Apply All
3. Vercel Dashboard â†’ Blob Store â†’ Copy token â†’ .env.local
4. npm run dev â†’ /profile â†’ test upload
5. vercel --prod â†’ LIVE! ğŸš€
```

**Ø§Ù„Ù†ØªÙŠØ¬Ø©: Profile V2.3 live â€” zero conflicts â€” JWT perfect!**[^2][^4]
<span style="display:none">[^10][^11][^12][^13][^14][^15][^16][^17][^18][^19][^20][^21][^22][^5][^6][^7][^8][^9]</span>

<div align="center">â‚</div>

[^1]: page.tsx
[^2]: dlyl-dmj-mlft-lmlf-lshkhSy-Profile-V2.3.md
[^3]: route.ts
[^4]: https://www.perplexity.ai/search/2dd97761-f844-4248-8d03-ae5028027134
[^5]: preferences.prompt_style
[^6]: figma_brief_new4_a.txt
[^7]: stara-v2.0.md__b.md
[^8]: pho_code_c.md
[^9]: sh-mqT-y.md
[^10]: FORENSIC_AUDIT_REPORT.md
[^11]: sh-nhyy-mn-mnws.md
[^12]: SfH-ltSwyt.md
[^13]: feedback_page_preview.html
[^14]: feedback_nextjs_page.ts
[^15]: feedback_api_routes.md
[^16]: production_api_routes.ts
[^17]: setup_instructions.md
[^18]: page.tsx
[^19]: route.ts
[^20]: installation_instructions_v23.md
[^21]: route.ts
[^22]: page.tsx```

